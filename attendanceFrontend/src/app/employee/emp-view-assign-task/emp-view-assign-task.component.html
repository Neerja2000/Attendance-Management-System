<div class="container mt-4">
  <div class="card mt-5">
    <div class="card-header">
      <div class="row">
        <div class="col-md-8">
          <h5 class="card-title">Assign Task List</h5>
        </div>
        <div class="col-md-4">
          <button class="btn btn-primary" [routerLink]="['/employee/layout/emp-assign-task',employeeId]">+ Assign Task</button>
        </div>
      </div>

    </div>
    <div class="card-body w-100">
      <form (ngSubmit)="filterTasks()">
        <div class="row mb-3">
          <div class="col-md-6">
            <label for="dateFilter" class="form-label">Date</label>
            <input type="date" id="dateFilter" class="form-control" [(ngModel)]="filters.date" name="date">
          </div>
          <div class="col-md-6 d-flex align-items-end">
            <button type="submit" class="btn btn-primary">Filter</button>
          </div>
        </div>
      </form>
      <table class="table table-striped" id="table1">
        <thead>
          <tr>
            <th>Week</th>
            <th>Tasks</th>
            <th>Status</th>
            <th>Due Date</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let detail of filteredTasks">
            <td>
              <ng-container *ngFor="let day of detail.assignedDays">
                {{ day.day }} ({{ day.date | date }})<br>
              </ng-container>
            </td>
            <td>{{ detail.taskId.taskName }}</td>
            <td>
              <button 
                class="badge btn"
                [ngClass]="{
                  'text-bg-success': detail.status === 'completed',
                  'text-bg-warning': detail.status === 'pending',
                  'text-bg-info': detail.status === 'started',
                  'text-bg-secondary': detail.status === 'waiting for approval',
                  'text-bg-danger': detail.status === 'under rivision',
                  'text-bg-dark': detail.status === 'Under Revision: Approval Pending'
                }"
                (click)="changeStatus(detail)"
              >
                {{ detail.status }}
              </button>
            </td>
            
            <td>
              <ng-container *ngIf="isDate(detail.taskId.expectedTime); else notADate">
                {{ detail.taskId.expectedTime | date }}
              </ng-container>
              <ng-template #notADate>
                {{ detail.taskId.expectedTime }}
              </ng-template>
            </td>
          </tr>
        </tbody>
      </table>
      
    </div>
  </div>
</div>
